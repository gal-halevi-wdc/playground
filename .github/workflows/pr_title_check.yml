name: "Verify PR Title"
on:
  pull_request:
    types: [opened, reopened, edited]
    paths-ignore:
      - '.github/**'
jobs:
  check-title:
    runs-on: ubuntu-latest
    steps:
    - name: Verify PR title
      uses: actions/github-script@v7
      with:
        github-token: ${{ secrets.GITHUB_TOKEN }}
        script: |
          const payload = context.payload
          const prTitle = payload.pull_request.title

          const jiraPattern = /[A-Z]+[0-9]*-[0-9]+: /g
          if (!jiraPattern.test(prTitle)) {
            core.summary.addRaw('PR title is not valid. Title should start with the following regex: ' + jiraPattern, true)
            core.setFailed()
          }
